(self.webpackChunkloft=self.webpackChunkloft||[]).push([[6172],{84602:function(e,n,t){"use strict";t.d(n,{Z:function(){return y}});var r=t(4942),o=t(15861),i=t(29439),a=t(87757),c=t.n(a),s=t(24149),l=t(16106),d=t(90841),x=t(67056),u=t(31881),p=t.n(u),h=t(69172),f=t(2360),b=t(5958),m=t(47313),j=t(58585),g=t.n(j),w=t(24511),v=t(46417);function y(e){var n,t=(0,w.$)().t,a=(0,m.useState)(!1),u=(0,i.Z)(a,2),j=u[0],y=u[1],Z=(0,m.useState)("unknown"),S=(0,i.Z)(Z,2),C=S[0],k=S[1],q=e.report,R=e.isAdmin,L=function(){var e=(0,o.Z)(c().mark((function e(){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p().get("".concat((0,h.Z)(),"/admin/convert_id_to_user?id=").concat(q.user_id),{headers:{authorization:"Bearer ".concat((0,f.Z)())}});case 2:(n=e.sent).data.error||k(n.data.user.username);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),z=function(e){return(0,v.jsx)(s.u,{borderWidth:"1px",style:{boxShadow:"0px 4px 6px -1px rgba(0, 0, 0, 0.01),0px 2px 4px -1px rgba(0, 0, 0, 0.06)"},borderRadius:"lg",label:e.name,hasArrow:!0,placement:"top",children:(0,v.jsx)(l.hU,{icon:e.icon,fontSize:"20px",variant:"ghost",_active:{boxShadow:"none!important"},_focus:{boxShadow:"none!important"},onClick:e.onClick})})};(0,m.useEffect)((function(){R&&L()}),[]);return(0,v.jsx)(d.xu,(n={mb:"20px",borderWidth:"1px",style:{boxShadow:"0px 4px 6px -1px rgba(0, 0, 0, 0.01),0px 2px 4px -1px rgba(0, 0, 0, 0.06)"},borderRadius:"lg"},(0,r.Z)(n,"style",{boxShadow:"0px 4px 6px -1px rgba(0, 0, 0, 0.01),0px 2px 4px -1px rgba(0, 0, 0, 0.06)"}),(0,r.Z)(n,"borderRadius","lg"),(0,r.Z)(n,"bgColor","white"),(0,r.Z)(n,"children",(0,v.jsx)(d.xu,{m:"20px",children:(0,v.jsxs)(d.Kq,{style:{WebkitBoxPack:"justify",justifyContent:"space-between"},direction:["column","row"],children:[(0,v.jsx)(d.M5,{children:(0,v.jsxs)(d.xv,{fontSize:"lg",fontWeight:"bold",children:[q.quarter," ",t("finance.quarter")," ",q.year," ",t("finance.year")]})}),(0,v.jsxs)(d.Kq,{direction:"row",spacing:"10px",children:[(0,v.jsx)(d.M5,{children:(0,v.jsxs)(d.Kq,{direction:"column",children:[(0,v.jsxs)(d.xv,{fontSize:"lg",fontWeight:"bold",children:[t("report.total"),": ",q.sum," \u20bd"]}),R&&(0,v.jsxs)(d.xv,{fontSize:"sm",children:["\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c: ",C]})]})}),(0,v.jsx)(d.Kq,{direction:["column","row"],spacing:"5px",children:(0,v.jsx)(d.M5,{children:!j&&(0,v.jsx)(z,{icon:(0,v.jsx)(b.JfT,{}),name:t("report.button.download"),onClick:function(){y(!0),p().get("https://api.codetabs.com/v1/proxy?quest=".concat((0,h.Z)()).concat(q.file),{responseType:"blob"}).then((function(e){var n="".concat(q.quarter," \u043a\u0432\u0430\u0440\u0442\u0430\u043b ").concat(q.year," \u0433\u043e\u0434\u0430.csv");g()(e.data,n),y(!1)}))}})||(0,v.jsx)(x.$,{color:"main"})})})]})]})})),n))}},6172:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return Z}});var r=t(1413),o=t(15861),i=t(29439),a=t(87757),c=t.n(a),s=t(90841),l=t(74511),d=(t(24149),t(16106)),x=t(44415),u=t(49056),p=t(67056),h=t(31881),f=t.n(h),b=t(69172),m=t(2360),j=t(47313),g=t(75627),w=t(29466),v=t(84602),y=t(46417);function Z(){var e=function(){return(0,y.jsx)(s.xu,{borderWidth:"1px",alignItems:"center",textAlign:"center",alignContent:"center",style:{boxShadow:"0px 4px 6px -1px rgba(0, 0, 0, 0.01),0px 2px 4px -1px rgba(0, 0, 0, 0.06)"},borderRadius:"lg",bgColor:"white",children:(0,y.jsx)(s.xu,{m:"20px",children:(0,y.jsxs)(s.Kq,{alignItems:"center",direction:"column",justifyContent:"center",paddingTop:"1.5rem",paddingBottom:"1.5rem",color:"gray.500",children:[(0,y.jsxs)("svg",{spacing:"2",xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",children:[(0,y.jsx)("path",{d:"M12 13.3c-.13 0-.26-.03-.38-.1L2.79 8.09a.752.752 0 1 1 .76-1.3L12 11.68l8.4-4.86a.76.76 0 0 1 1.03.27c.21.36.08.82-.27 1.03l-8.77 5.08a.94.94 0 0 1-.39.1Z",fill:"currentColor"}),(0,y.jsx)("path",{d:"M12 22.36c-.41 0-.75-.34-.75-.75v-9.07c0-.41.34-.75.75-.75s.75.34.75.75v9.07c0 .41-.34.75-.75.75Z",fill:"currentColor"}),(0,y.jsx)("path",{d:"M12 22.75c-.88 0-1.75-.19-2.44-.57l-5.34-2.97c-1.45-.8-2.58-2.73-2.58-4.39V9.17c0-1.66 1.13-3.58 2.58-4.39l5.34-2.96c1.37-.76 3.51-.76 4.88 0l5.34 2.97c1.45.8 2.58 2.73 2.58 4.39v5.65c0 1.66-1.13 3.58-2.58 4.39l-5.34 2.96c-.69.38-1.56.57-2.44.57Zm0-20c-.63 0-1.25.13-1.71.38L4.95 6.1c-.96.53-1.81 1.97-1.81 3.07v5.65c0 1.1.85 2.54 1.81 3.08l5.34 2.97c.91.51 2.51.51 3.42 0l5.34-2.97c.96-.54 1.81-1.97 1.81-3.08V9.17c0-1.1-.85-2.54-1.81-3.08l-5.34-2.97c-.46-.24-1.08-.37-1.71-.37Z",fill:"currentColor"})]}),(0,y.jsx)(s.xv,{fontSize:"lg",fontWeight:"bold",children:"\u0414\u0430\u043d\u043d\u044b\u0435 \u0434\u043b\u044f \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0430 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442"})]})})})},n=j.useState(!1),t=(0,i.Z)(n,2),a=t[0],h=t[1],Z=j.useState(!1),S=(0,i.Z)(Z,2),C=S[0],k=S[1],q=j.useState(null),R=(0,i.Z)(q,2),L=R[0],z=R[1],U=j.useState(!1),W=(0,i.Z)(U,2),B=W[0],_=W[1],I=j.useState(!1),M=(0,i.Z)(I,2),A=M[0],K=M[1],O=(0,g.cI)(),T=O.register,E=O.handleSubmit,J=(0,l.pm)(),P=function(){var e=(0,o.Z)(c().mark((function e(n){var t,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(_(!1),K(!0),t=!1,e.prev=3,n.year||(h("\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0433\u043e\u0434"),t=!0),n.quarter||(k("\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043a\u0432\u0430\u0440\u0442\u0430\u043b"),t=!0),t){e.next=11;break}return e.next=9,f().get("".concat((0,b.Z)(),"/admin/find_report?year=").concat(n.year,"&quarter=").concat(n.quarter),{headers:{authorization:"Bearer ".concat((0,m.Z)())}});case 9:(r=e.sent).data.error?J({position:"top",title:"\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430!",description:"".concat(r.data.error),status:"error",duration:3e3,isClosable:!0}):z(r.data.financial);case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),J({position:"top",title:"\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430!",description:"".concat(e.t0),status:"error",duration:3e3,isClosable:!0});case 16:return e.prev=16,_(!0),K(!1),e.finish(16);case 20:case"end":return e.stop()}}),e,null,[[3,13,16,20]])})));return function(n){return e.apply(this,arguments)}}(),$=function(){var e=(0,o.Z)(c().mark((function e(){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f().get("".concat((0,b.Z)(),"/admin/get_reports"),{headers:{authorization:"Bearer ".concat((0,m.Z)())}});case 2:n=e.sent,z(n.data.financial),_(!0);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();j.useEffect((function(){B||$()}),[]);return(0,y.jsxs)(s.xu,{children:[(0,y.jsx)(s.X6,{size:"2xl",children:"\u0424\u0438\u043d\u0430\u043d\u0441\u044b"}),(0,y.jsxs)(s.xu,{mt:"20px",children:[(0,y.jsx)(s.xu,{borderWidth:"1px",style:{boxShadow:"0px 4px 6px -1px rgba(0, 0, 0, 0.01),0px 2px 4px -1px rgba(0, 0, 0, 0.06)"},borderRadius:"lg",maxW:"lg",bgColor:"white",children:(0,y.jsx)(s.xu,{m:"20px",children:(0,y.jsxs)("form",{onSubmit:E(P),children:[(0,y.jsxs)(s.Kq,{direction:["column","row"],spacing:"10px",children:[(0,y.jsxs)(x.NI,{isInvalid:C,onChange:function(){k(!1)},children:[(0,y.jsxs)(u.Ph,(0,r.Z)((0,r.Z)({placeholder:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043a\u0432\u0430\u0440\u0442\u0430\u043b",isDisabled:A},T("quarter")),{},{children:[(0,y.jsx)("option",{value:"1",children:"1 \u043a\u0432\u0430\u0440\u0442\u0430\u043b"}),(0,y.jsx)("option",{value:"2",children:"2 \u043a\u0432\u0430\u0440\u0442\u0430\u043b"}),(0,y.jsx)("option",{value:"3",children:"3 \u043a\u0432\u0430\u0440\u0442\u0430\u043b"}),(0,y.jsx)("option",{value:"4",children:"4 \u043a\u0432\u0430\u0440\u0442\u0430\u043b"})]})),C&&(0,y.jsx)(x.J1,{children:C})]}),(0,y.jsxs)(x.NI,{isInvalid:a,onChange:function(){h(!1)},children:[(0,y.jsxs)(u.Ph,(0,r.Z)((0,r.Z)({placeholder:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0433\u043e\u0434",isDisabled:A},T("year")),{},{children:[(0,y.jsx)("option",{value:"2024",children:"2024"}),(0,y.jsx)("option",{value:"2025",children:"2025"})]})),a&&(0,y.jsx)(x.J1,{children:a})]})]}),(0,y.jsx)(d.zx,{mt:"10px",w:"100%",type:"submit",isLoading:A,colorScheme:"teal",children:"\u041d\u0430\u0439\u0442\u0438"})]})})}),(0,y.jsx)(s.xu,{mt:"20px",maxW:"sm",children:(0,y.jsx)(d.zx,{variant:"outline",colorScheme:"teal",as:w.rU,to:"/admin/finance/add",children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u044b\u0439 \u043e\u0442\u0447\u0435\u0442"})}),(0,y.jsx)(s.xu,{mt:"20px",children:!B&&(0,y.jsx)(s.M5,{children:(0,y.jsx)(p.$,{color:"main",size:"xl"})})||(0,y.jsx)(s.xu,{children:0===L.length&&(0,y.jsx)(e,{})||(0,y.jsx)(s.xu,{mt:"20px",maxW:"full",children:L.map((function(e){return(0,y.jsx)(v.Z,{isAdmin:!0,report:e})}))})})})]})]})}},58585:function(e){e.exports=function(e,n,t,r){var o=new Blob("undefined"!==typeof r?[r,e]:[e],{type:t||"application/octet-stream"});if("undefined"!==typeof window.navigator.msSaveBlob)window.navigator.msSaveBlob(o,n);else{var i=window.URL&&window.URL.createObjectURL?window.URL.createObjectURL(o):window.webkitURL.createObjectURL(o),a=document.createElement("a");a.style.display="none",a.href=i,a.setAttribute("download",n),"undefined"===typeof a.download&&a.setAttribute("target","_blank"),document.body.appendChild(a),a.click(),setTimeout((function(){document.body.removeChild(a),window.URL.revokeObjectURL(i)}),200)}}}}]);