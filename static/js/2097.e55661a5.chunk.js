(self.webpackChunkloft=self.webpackChunkloft||[]).push([[2097],{22097:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Z}});var r=n(37762),o=n(15861),a=n(29439),s=n(87757),i=n.n(s),c=n(74511),l=n(90841),u=n(67056),d=n(44415),p=n(16106),x=n(12520),h=n(47402),f=n(31881),m=n.n(f),b=n(69172),g=n(2360),v=n(47313),w=n(19469),j=n(24511),y=n(58585),k=n.n(y),S=n(46417);function Z(){var e=v.useState(null),t=(0,a.Z)(e,2),n=t[0],s=t[1],f=v.useState(!1),y=(0,a.Z)(f,2),Z=y[0],C=y[1],L=v.useState(!1),R=(0,a.Z)(L,2),_=R[0],U=R[1],z=v.useState(null),B=(0,a.Z)(z,2),N=B[0],W=B[1],I=v.useState(null),O=(0,a.Z)(I,2),X=O[0],A=O[1],E=v.useState(!1),q=(0,a.Z)(E,2),F=q[0],P=q[1],T=(0,c.pm)(),$=(0,j.$)().t,D=function(){var e=(0,o.Z)(i().mark((function e(){var t,n,o,a,c,l;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m().get("".concat((0,b.Z)(),"/admin/get_releases?type=ok"),{headers:{authorization:"Bearer ".concat((0,g.Z)())}});case 3:if((t=e.sent).data.error)T({position:"top",title:"\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430!",description:t.data.error,status:"error",duration:3e3,isClosable:!0});else{n=t.data.releases,o=[],a=(0,r.Z)(n);try{for(a.s();!(c=a.n()).done;)l=c.value,o.push({value:l.id,label:"".concat(l.artists," - ").concat(l.title)})}catch(i){a.e(i)}finally{a.f()}s(o),C(!0)}e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),T({position:"top",title:"\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430!",description:"".concat(e.t0),status:"error",duration:3e3,isClosable:!0});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();v.useEffect((function(){n||D()}),[]);var M=function(){var e=(0,o.Z)(i().mark((function e(t){var n,r,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=document.getElementsByName("release")[0].value)){e.next=11;break}return C(!1),e.next=5,m().get("".concat((0,b.Z)(),"/admin/get_release_info?id=").concat(n),{headers:{authorization:"Bearer ".concat((0,g.Z)())}});case 5:r=e.sent,o=r.data,W(o.release),C(!0),e.next=12;break;case 11:t&&T({position:"top",title:$("posters.placeholder.release"),status:"error",duration:3e3,isClosable:!0});case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),G=function(){var e=(0,o.Z)(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(U(!0),t="Single"===N.type?"\u0441\u0438\u043d\u0433\u043b":N.type,X){e.next=6;break}return T({position:"top",title:$("posters.placeholder.genre"),status:"error",duration:3e3,isClosable:!0}),U(!1),e.abrupt("return");case 6:"Album"===t&&(t="\u0430\u043b\u044c\u0431\u043e\u043c"),m().get("https://api.codetabs.com/v1/proxy?quest=https://image.loftlabel.ru/createimage?title=".concat(N.title,"&artist=").concat(N.artists,"&genre=").concat(X,"&type=").concat(t,"&cover=").concat((0,b.Z)()).concat(N.cover),{responseType:"blob"}).then((function(e){var t="".concat(N.artists," - ").concat(N.title,".png");k()(e.data,t),T({position:"top",title:$("posters.toast.success"),status:"success",duration:3e3,isClosable:!0}),W(""),A(null),P(!1),U(!1)}));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,S.jsxs)(l.xu,{children:[(0,S.jsx)(l.X6,{size:"2xl",children:$("menu.posters")}),!Z&&(0,S.jsx)(l.M5,{children:(0,S.jsx)(u.$,{color:"main",size:"xl"})})||(0,S.jsx)(l.xu,{maxW:"3xl",mt:"20px",borderWidth:"1px",style:{boxShadow:"0px 4px 6px -1px rgba(0, 0, 0, 0.01),0px 2px 4px -1px rgba(0, 0, 0, 0.06)"},borderRadius:"lg",bgColor:"white",children:(0,S.jsxs)(l.xu,{m:"40px",children:[(0,S.jsx)(l.xv,{fontSize:"xl",fontWeight:"bold",mb:"20px",children:$("posters.create")}),!N&&(0,S.jsx)(l.xu,{mt:"20px",children:(0,S.jsxs)("form",{id:"getrelease",children:[(0,S.jsxs)(d.NI,{mt:"10px",children:[(0,S.jsx)(d.lX,{fontWeight:"bold",htmlFor:"release",children:$("posters.placeholder.release.title")}),(0,S.jsx)(w.ZP,{className:"basic-single",classNamePrefix:"select",isLoading:_,isSearchable:!0,placeholder:$("posters.placeholder.release"),name:"release",options:n,onChange:function(){M()}})]}),(0,S.jsx)(p.zx,{w:"100%",mt:"20px",colorScheme:"teal",_focus:{boxShadow:"none!important"},_active:{boxShadow:"none!important"},onClick:function(){M(!0)},isLoading:_,children:$("posters.button.next")})]})})||(0,S.jsx)(l.xu,{mt:"20px",children:(0,S.jsxs)("form",{id:"main",children:[(0,S.jsx)(x.Input,{id:"release_id",type:"integer",required:!0,hidden:!0,value:N,name:"release_id"}),(0,S.jsxs)(d.NI,{paddingBottom:"10px",children:[(0,S.jsx)(d.lX,{fontWeight:"bold",htmlFor:"sum",children:$("posters.placeholder.genre.title")}),(0,S.jsx)(x.Input,{id:"genre",type:"text",name:"genre",value:X,onChange:function(e){A(e.target.value)},placeholder:$("posters.placeholder.genre"),isDisabled:F})]}),(0,S.jsx)(h.XZ,{onChange:function(e){e.target.checked?A(N.genre):A(""),P(e.target.checked)},colorScheme:"teal",children:$("posters.checkbox")}),(0,S.jsx)(p.zx,{w:"100%",mt:"20px",colorScheme:"teal",_focus:{boxShadow:"none!important"},_active:{boxShadow:"none!important"},onClick:G,isLoading:_,children:$("posters.button.create")})]})})]})})]})}},58585:function(e){e.exports=function(e,t,n,r){var o=new Blob("undefined"!==typeof r?[r,e]:[e],{type:n||"application/octet-stream"});if("undefined"!==typeof window.navigator.msSaveBlob)window.navigator.msSaveBlob(o,t);else{var a=window.URL&&window.URL.createObjectURL?window.URL.createObjectURL(o):window.webkitURL.createObjectURL(o),s=document.createElement("a");s.style.display="none",s.href=a,s.setAttribute("download",t),"undefined"===typeof s.download&&s.setAttribute("target","_blank"),document.body.appendChild(s),s.click(),setTimeout((function(){document.body.removeChild(s),window.URL.revokeObjectURL(a)}),200)}}}}]);